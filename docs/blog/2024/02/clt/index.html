<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="jp Monteagudo">
<meta name="description" content="Shining a light on the Central Limit Theorem and the mythical sample size requirements for the health and social sciences">
<title>What’s this CLT, please? A straightforward explanation of the Central Limit Theorem and the magic (\(n =30\)) sample size requirements | jp Monteagudo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../..//files/cards/favicon_no_bg.png" rel="icon" type="image/png">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SM9D5VRX5P"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SM9D5VRX5P', { 'anonymize_ip': true});
</script><style>

      .quarto-title-block .quarto-title-banner {
        background: #112540;
      }
</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.css">
<meta property="og:title" content="What’s this CLT, please? A straightforward explanation of the Central Limit Theorem and the magic (\(n =30\)) sample size requirements | jp Monteagudo">
<meta property="og:description" content="Shining a light on the Central Limit Theorem and the mythical sample size requirements for the health and social sciences">
<meta property="og:image" content="https://www.jpmonteagudo.com/files/cards/favicon_no_bg.png">
<meta property="og:site_name" content="jp monteagudo">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="357">
<meta property="og:image:width" content="334">
<meta name="twitter:title" content="What’s this CLT, please? A straightforward explanation of the Central Limit Theorem and the magic (\(n =30\)) sample size requirements | jp Monteagudo">
<meta name="twitter:description" content="Shining a light on the Central Limit Theorem and the mythical sample size requirements for the health and social sciences">
<meta name="twitter:image" content="https://www.jpmonteagudo.com/files/cards/favicon_no_bg.png">
<meta name="twitter:creator" content="@jpPabl0">
<meta name="twitter:site" content="@jpPabl0">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="357">
<meta name="twitter:image-width" content="334">
</head>
<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">jp monteagudo</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../cv/index.html"> 
<span class="menu-text">cv</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog/index.html"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../research/index.html"> 
<span class="menu-text">research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../now/index.html"> 
<span class="menu-text">now</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../uses/index.html"> 
<span class="menu-text">uses</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="../../../../atom.xml"> <i class="bi bi-rss" role="img" aria-label="rss">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:jpmonteagudo2014@gmail.com"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jpPabl0" rel="me"> <i class="bi bi-twitter" role="img" aria-label="twitter">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jpmonteagudo28" rel="me"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/juan-pablo-jp-monteagudo-71127bab/" rel="me"> <i class="bi bi-linkedin" role="img" aria-label="linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default blog-post page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">What’s this CLT, please? A straightforward explanation of the Central Limit Theorem and the magic (<span class="math inline">\(n =30\)</span>) sample size requirements</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          Shining a light on the Central Limit Theorem and the mythical sample size requirements for the health and social sciences
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">r</div>
                <div class="quarto-category">clt</div>
                <div class="quarto-category">sample size</div>
                <div class="quarto-category">Lyndeberg-Lévy</div>
                <div class="quarto-category">Gaussian</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://www.jpmonteagudo.com/">JP Monteagudo</a> <a href="https://orcid.org/0009-0003-6465-6658" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Wednesday, March 6, 2024</p>
      </div>
    </div>
    
      
      <div>
      <div class="quarto-title-meta-heading">Doi</div>
      <div class="quarto-title-meta-contents">
        <p class="doi">
          <a href="https://doi.org/10.59350/bje88-8r592">10.59350/bje88-8r592</a>
        </p>
      </div>
    </div>
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li>
<a href="#the-central-limit-theorem" id="toc-the-central-limit-theorem" class="nav-link active" data-scroll-target="#the-central-limit-theorem">The Central Limit Theorem</a>
  <ul class="collapse">
<li><a href="#random-processes" id="toc-random-processes" class="nav-link" data-scroll-target="#random-processes">Random processes</a></li>
  <li><a href="#independence-and-identical-distribution" id="toc-independence-and-identical-distribution" class="nav-link" data-scroll-target="#independence-and-identical-distribution">Independence and identical distribution</a></li>
  <li><a href="#additive-processes" id="toc-additive-processes" class="nav-link" data-scroll-target="#additive-processes">Additive processes</a></li>
  </ul>
</li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><section id="the-central-limit-theorem" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="the-central-limit-theorem">The Central Limit Theorem</h2>
<p>The rudiments of the Central Limit Theorem (CLT) can be traced back to Bernoulli, who famously penned: “even the stupidest person without any prior instruction knows that the more observations are made, the less danger there is of missing the target”, hinting at the notion that, as the number of trials increases, even a simpleton can eventually arrive at the expected outcome.</p>
<p>The theorem derives its name from the fact that we’re using a parameter of <em>central</em> tendency – typically the mean, median, or mode– to arrive at the <em>limiting distribution</em> of independent random variables– which, under certain conditions, will typically be the standard normal distribution.</p>
<p>To put it differently, by sampling a finite population an increasing number of times and using the mean of the <span class="math inline">\(n\)</span> samples as our metric, we will see how our histogram for the population of sampled means will conform to a standard normal curve. By estimating the limiting distribution– the beloved normal distribution– of our independent variables, the theorem helps us answer the question:</p>
<blockquote class="blockquote">
<p>If an outcome <span class="math inline">\(p\)</span> has occurred <span class="math inline">\(p\)</span> times out of <span class="math inline">\(p + q = n\)</span> number of trials, what’s the probability of our desired outcome occurring <span class="math inline">\(r\)</span> times in a further <span class="math inline">\(r + q = m\)</span> number of trials?</p>
</blockquote>
<p>Let’s now talk about the <strong>conditions</strong> we must meet for our distribution to converge or arrive at the standard normal distribution with mean equal to zero and variance equal to 1.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>I’ll start referring to a standard normal distribution with mean equal to zero and variance equal to 1 by using the following notation <span class="math inline">\(\mathcal{N}(0,1)\)</span></p>
</div></div><section id="random-processes" class="level3"><h3 class="anchored" data-anchor-id="random-processes">Random processes</h3>
<p>The variables under study must be the outcome of a random phenomenon for which we know the type of outcomes that can happen but cannot know how or when they will occur. We can know some of the causes of this phenomenon, but their deviations from a supposed pattern are unknown to us.</p>
<p>A classic example of a random variable is a game of cards in which we know what the cards on the deck are but cannot tell which one will come up next– unless we cheat and then the whole thing is not a random phenomenon anymore. In the life and social sciences, we can find random variables everywhere: the height and weight of a population, hemoglobin levels in healthy adults, the number of patients in the ER on any given night, pH levels in different types of topsoil or the scores on the UCLA Loneliness scale. The common thread here is that one <em>random</em> observation doesn’t provide information on the occurrence of the next one.</p>
</section><section id="independence-and-identical-distribution" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="independence-and-identical-distribution">Independence and identical distribution</h3>
<p>In the life and social sciences, we’ll typically see <em>conditional independence</em>, where variables <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are measurements of the same underlying quantity <span class="math inline">\(C\)</span>. We say that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are conditionally independent if, once C is known, the value of <span class="math inline">\(B\)</span> doesn’t give new information about <span class="math inline">\(A\)</span>. Knowing what happens to <span class="math inline">\(B\)</span> after <span class="math inline">\(C\)</span> takes place doesn’t increase our chances of correctly predicting the outcome of <span class="math inline">\(A\)</span>. In addition, independent variables are also uncorrelated – their covariance (<span class="math inline">\(cov[A,B] = E[A]\cdot E[B]\)</span>) and Pearson’s <span class="math inline">\(r\)</span> (<span class="math inline">\(\rho_{X,Y} = \frac{cov[A,B]}{\sigma_{A}\sigma_{B}}\)</span>​) are equal to zero.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-group="r-graph">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r numberLines number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>clrs <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="co"># Creating custom color palette</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="st">"#FFBE00"</span>, <span class="co">#  yellow</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="st">"#B92F0A"</span>, <span class="co">#  red</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="st">"#7C225C"</span>, <span class="co">#  purple</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="st">"#792A26"</span>, <span class="co">#  brown</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="st">"#242424"</span>, <span class="co">#  dark gray</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="st">"#394DAA"</span>) <span class="co">#  blue</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="at">by=</span>.<span class="dv">01</span>) <span class="co"># Creating variable to use in dens. curve</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="do">## Plot graphics</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">par</span>(<span class="at">las =</span> <span class="dv">1</span>, <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mai =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">1</span>))</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="do">## Plot graphics</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">plot</span>(xx, <span class="fu">dnorm</span>(xx, <span class="sc">-</span><span class="dv">1</span>),<span class="at">type =</span> <span class="st">"b"</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="at">col =</span> clrs[<span class="dv">3</span>], <span class="at">main =</span> <span class="st">"Identically distributed"</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">lines</span>(xx, <span class="fu">dnorm</span>(xx, <span class="sc">-</span><span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">18</span>, <span class="at">col =</span> clrs[<span class="dv">1</span>])</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="at">col =</span> <span class="fu">c</span>(clrs[<span class="dv">3</span>], clrs[<span class="dv">1</span>]), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="do">## Plot graphics</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">plot</span>(xx,<span class="fu">dnorm</span>(xx,<span class="sc">-</span><span class="dv">1</span>),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>,</span>
<span id="cb1-20"><a href="#cb1-20"></a>     <span class="at">col =</span> clrs[<span class="dv">3</span>],<span class="at">main=</span><span class="st">"Shift in means"</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu">lines</span>(xx,<span class="fu">dnorm</span>(xx,<span class="dv">1</span>),<span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>,<span class="at">pch =</span> <span class="dv">18</span>,<span class="at">col=</span> clrs[<span class="dv">1</span>])</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb1-23"><a href="#cb1-23"></a>       <span class="at">col =</span> <span class="fu">c</span>(clrs[<span class="dv">3</span>], clrs[<span class="dv">1</span>]), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="do">## Plot graphics</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">plot</span>(xx,<span class="fu">dnorm</span>(xx,<span class="sc">-</span><span class="dv">1</span>),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>,</span>
<span id="cb1-26"><a href="#cb1-26"></a>     <span class="at">col =</span> clrs[<span class="dv">3</span>], <span class="at">main =</span> <span class="st">"Different distributions"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>))</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">lines</span>(xx, <span class="fu">dchisq</span>(xx, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> clrs[<span class="dv">1</span>])</span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb1-29"><a href="#cb1-29"></a>       <span class="at">col =</span> <span class="fu">c</span>(clrs[<span class="dv">3</span>], clrs[<span class="dv">1</span>]), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/fig_iid-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1" title="Simulated identically distributed and non-identically distributed variables."><img src="index_files/figure-html/fig_iid-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Simulated identically distributed and non-identically distributed variables."></a></p>
<figcaption>Simulated identically distributed and non-identically distributed variables.</figcaption></figure>
</div>
</div></div></div>
<p>Additionally, two variables <span class="math inline">\(A_{n}\)</span> and <span class="math inline">\(B_{n}\)</span> are identically distributed when their probability distributions match exactly, and their means and variances (<span class="math inline">\(\mu_{A} = \mu_{B}, \sigma_{A}^2 = \sigma_{B}^2\)</span>​​​) are equal. By now you can already see how this assumption can at best be approximated and almost impossible to demonstrate by the variables commonly studied in the life and social sciences.</p>
<p>Let’s look at a hypothetical example of conditional independence:</p>
<p>Let’s say a microchip manufacturer records the weekly number of defective microchips (<code>def_micros</code>) for each of its 8–hour shifts to evaluate whether the number of complaints (<code>complaints</code>) received in 24 hours is related to <code>def_micro</code>. They also want to know if the number of complaints given <code>def_micro</code> is related to the number of devices (<code>devices</code>) bought and returned through their online retailer. . To answer this question, we first need to determine that <code>complaints</code> and <code>devices</code> are conditionally independent if, each variable is associated with<code>def_micr0</code>, but their <a href="https://en.wikipedia.org/wiki/Partial_correlation">partial correlation</a> coefficient is close to zero. We then calculate the zero-order correlation and compare it to the first–order correlation given the number of defective microchips. In our example, the zero-order correlation between devices and complaints is <span class="math inline">\(\rho = .099\)</span> and the first–order correlation is technically non-existent <span class="math inline">\(\rho = -.021\)</span>, and we can assume <code>devices</code> and <code>complaints</code> are conditionally independent.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-fig-cap-label="cond_ind" data-group="r-graph">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r numberLines number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="do">##---------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="do">## Generating two random variables that meet the i.i.d assumption</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="do">## --------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(here)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(ppcor)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="fu">library</span>(showtext)</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="do">##------------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="do">## Generating two conditionally independent random variables</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="do">## ------------------------------------------------------------------------------------ ##</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="do">## Creating function to generate random variable with defined correlation to an existing var.</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>complement <span class="ot">&lt;-</span> <span class="cf">function</span>(y, rho, x) { <span class="co"># corr. coefficient</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(x)) x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">length</span>(y), <span class="dv">2</span>, .<span class="dv">5</span>) <span class="co"># Optional: supply a default if `x` is not given</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>  y.perp <span class="ot">&lt;-</span> <span class="fu">residuals</span>(<span class="fu">lm</span>(x <span class="sc">~</span> y))</span>
<span id="cb2-17"><a href="#cb2-17"></a>  rho <span class="sc">*</span> <span class="fu">sd</span>(y.perp) <span class="sc">*</span> y <span class="sc">+</span> y.perp <span class="sc">*</span> <span class="fu">sd</span>(y) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-18"><a href="#cb2-18"></a>}</span>
<span id="cb2-19"><a href="#cb2-19"></a>def_micro <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1050</span>, <span class="dv">6</span>) <span class="co"># lambda = n*p, p = .006 defective microchips </span></span>
<span id="cb2-20"><a href="#cb2-20"></a>complaints <span class="ot">&lt;-</span> <span class="fu">complement</span>(def_micro, <span class="at">rho =</span> .<span class="dv">273</span>) <span class="co"># no. complaints received on 24 hr period </span></span>
<span id="cb2-21"><a href="#cb2-21"></a>devices <span class="ot">&lt;-</span> <span class="fu">complement</span>(def_micro, <span class="at">rho =</span> .<span class="dv">331</span>) <span class="co"># weekly no. devices processed at online retailer</span></span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="do">## Creating function to summarize list of variables</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>group_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb2-25"><a href="#cb2-25"></a>  summaries <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">list</span>(...), summary)</span>
<span id="cb2-26"><a href="#cb2-26"></a>  <span class="fu">names</span>(summaries) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Summary_"</span>, <span class="fu">seq_along</span>(summaries))</span>
<span id="cb2-27"><a href="#cb2-27"></a>  <span class="fu">return</span>(summaries)</span>
<span id="cb2-28"><a href="#cb2-28"></a>}</span>
<span id="cb2-29"><a href="#cb2-29"></a></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="fu">group_summary</span>(def_micro, devices, complaints)</span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="do">## $Summary_1</span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="do">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="do">##    0.00    4.00    6.00    6.09    8.00   14.00 </span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="do">## </span></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="do">## $Summary_2</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="do">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="do">##    -7.2     0.8     4.6     6.0     9.8    48.9 </span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="do">## </span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="do">## $Summary_3</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="do">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="do">##    -7.2    -0.3     3.3     4.5     8.0    34.8</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="do">## ------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="do">## Creating function to find Spearman's rho among all variables</span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="do">## ------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>spearman_correlation <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb2-46"><a href="#cb2-46"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(...)</span>
<span id="cb2-47"><a href="#cb2-47"></a>  correlation_matrix <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(df, <span class="at">method =</span> <span class="st">"spearman"</span>), <span class="dv">3</span>)</span>
<span id="cb2-48"><a href="#cb2-48"></a>  <span class="fu">return</span>(correlation_matrix)</span>
<span id="cb2-49"><a href="#cb2-49"></a>}</span>
<span id="cb2-50"><a href="#cb2-50"></a>spearman <span class="ot">&lt;-</span> <span class="fu">spearman_correlation</span>(def_micro, devices, complaints)</span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="do">##</span></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="do">##              def_micro devices complaints</span></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="do">## def_micro      1.000   0.378      0.297</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="do">## devices        0.378   1.000      0.099</span></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="do">## complaints     0.297   0.099      1.000</span></span>
<span id="cb2-56"><a href="#cb2-56"></a></span>
<span id="cb2-57"><a href="#cb2-57"></a></span>
<span id="cb2-58"><a href="#cb2-58"></a><span class="do">## Use ppcor package to calculate partial correlation between complaints and devices</span></span>
<span id="cb2-59"><a href="#cb2-59"></a>part_cor <span class="ot">&lt;-</span> ppcor<span class="sc">::</span><span class="fu">pcor.test</span>(devices, complaints, def_micro, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb2-60"><a href="#cb2-60"></a><span class="do">##      estimate  p.value  statistic  n gp   Method</span></span>
<span id="cb2-61"><a href="#cb2-61"></a><span class="do">##  -0.02075897 0.501827 -0.6718506 1050  1 spearman</span></span>
<span id="cb2-62"><a href="#cb2-62"></a><span class="do">## Relationship between devices and complaints is technically non-existent.</span></span>
<span id="cb2-63"><a href="#cb2-63"></a><span class="do">## We can say they're conditionally independent.</span></span>
<span id="cb2-64"><a href="#cb2-64"></a><span class="do">## -------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-65"><a href="#cb2-65"></a><span class="do">## Creating scatterplots to visualize relationship between variables</span></span>
<span id="cb2-66"><a href="#cb2-66"></a><span class="do">## -------------------------------------------------------------------------------- ##</span></span>
<span id="cb2-67"><a href="#cb2-67"></a><span class="co"># Custom ggplot theme to make nicer plots</span></span>
<span id="cb2-68"><a href="#cb2-68"></a><span class="co"># Get the font at https://fonts.google.com/specimen/Fira+Sans+Condensed</span></span>
<span id="cb2-69"><a href="#cb2-69"></a><span class="fu">font_add_google</span>(<span class="st">"Fira Sans"</span>)</span>
<span id="cb2-70"><a href="#cb2-70"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb2-71"><a href="#cb2-71"></a>theme_nice <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-72"><a href="#cb2-72"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans Condensed"</span>) <span class="sc">+</span></span>
<span id="cb2-73"><a href="#cb2-73"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-74"><a href="#cb2-74"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-75"><a href="#cb2-75"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Fira Sans Condensed Bold"</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.35</span>)),</span>
<span id="cb2-76"><a href="#cb2-76"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Fira Sans Condensed Medium"</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>)),</span>
<span id="cb2-77"><a href="#cb2-77"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Fira Sans Condensed SemiBold"</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>)),</span>
<span id="cb2-78"><a href="#cb2-78"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb2-79"><a href="#cb2-79"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb2-80"><a href="#cb2-80"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Fira Sans Condensed Light"</span>, <span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">0.8</span>)),</span>
<span id="cb2-81"><a href="#cb2-81"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb2-82"><a href="#cb2-82"></a>        <span class="at">family =</span> <span class="st">"Fira Sans Condensed"</span>, <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb2-83"><a href="#cb2-83"></a>        <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb2-84"><a href="#cb2-84"></a>      ),</span>
<span id="cb2-85"><a href="#cb2-85"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb2-86"><a href="#cb2-86"></a>    )</span>
<span id="cb2-87"><a href="#cb2-87"></a>}</span>
<span id="cb2-88"><a href="#cb2-88"></a></span>
<span id="cb2-89"><a href="#cb2-89"></a>theme_nice_dist <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-90"><a href="#cb2-90"></a>  <span class="fu">theme_nice</span>() <span class="sc">+</span></span>
<span id="cb2-91"><a href="#cb2-91"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-92"><a href="#cb2-92"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-93"><a href="#cb2-93"></a>      <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="at">units =</span> <span class="st">"pt"</span>),</span>
<span id="cb2-94"><a href="#cb2-94"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>),</span>
<span id="cb2-95"><a href="#cb2-95"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb2-96"><a href="#cb2-96"></a>    )</span>
<span id="cb2-97"><a href="#cb2-97"></a>}</span>
<span id="cb2-98"><a href="#cb2-98"></a></span>
<span id="cb2-99"><a href="#cb2-99"></a><span class="fu">theme_set</span>(<span class="fu">theme_nice</span>())</span>
<span id="cb2-100"><a href="#cb2-100"></a></span>
<span id="cb2-101"><a href="#cb2-101"></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(<span class="st">"label"</span>, <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Fira Sans Condensed SemiBold"</span>, <span class="at">fontface =</span> <span class="st">"plain"</span>))</span>
<span id="cb2-102"><a href="#cb2-102"></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(<span class="st">"text"</span>, <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Fira Sans Condensed SemiBold"</span>, <span class="at">fontface =</span> <span class="st">"plain"</span>))</span>
<span id="cb2-103"><a href="#cb2-103"></a></span>
<span id="cb2-104"><a href="#cb2-104"></a><span class="co"># Making df with previously created variables</span></span>
<span id="cb2-105"><a href="#cb2-105"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(def_micro, devices, complaints)</span>
<span id="cb2-106"><a href="#cb2-106"></a><span class="co"># Making plot to show correlation between devices v. complaints.</span></span>
<span id="cb2-107"><a href="#cb2-107"></a>dev_comp_plot <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(devices, complaints)) <span class="sc">+</span></span>
<span id="cb2-108"><a href="#cb2-108"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clrs[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb2-109"><a href="#cb2-109"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="co"># Use either glm or gam models</span></span>
<span id="cb2-110"><a href="#cb2-110"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-111"><a href="#cb2-111"></a>    <span class="at">color =</span> clrs[<span class="dv">5</span>],</span>
<span id="cb2-112"><a href="#cb2-112"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-113"><a href="#cb2-113"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-114"><a href="#cb2-114"></a>    <span class="at">x =</span> <span class="st">"devices"</span>,</span>
<span id="cb2-115"><a href="#cb2-115"></a>    <span class="at">y =</span> <span class="st">"complaints"</span>) <span class="sc">+</span></span>
<span id="cb2-116"><a href="#cb2-116"></a>  <span class="fu">theme_nice_dist</span>() <span class="co"># Apply a custom theme</span></span>
<span id="cb2-117"><a href="#cb2-117"></a><span class="co"># Making plot to show correlation between devices v. microchips</span></span>
<span id="cb2-118"><a href="#cb2-118"></a>dev_micro_plot <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(devices, def_micro)) <span class="sc">+</span></span>
<span id="cb2-119"><a href="#cb2-119"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clrs[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb2-120"><a href="#cb2-120"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb2-121"><a href="#cb2-121"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-122"><a href="#cb2-122"></a>    <span class="at">color =</span> clrs[<span class="dv">5</span>],</span>
<span id="cb2-123"><a href="#cb2-123"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-124"><a href="#cb2-124"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-125"><a href="#cb2-125"></a>    <span class="at">x =</span> <span class="st">"devices"</span>,</span>
<span id="cb2-126"><a href="#cb2-126"></a>    <span class="at">y =</span> <span class="st">"microchips"</span>) <span class="sc">+</span></span>
<span id="cb2-127"><a href="#cb2-127"></a>  <span class="fu">theme_nice_dist</span>() <span class="co"># Apply a custom theme</span></span>
<span id="cb2-128"><a href="#cb2-128"></a><span class="co"># Making plot to show correlation between complaints v. microchips</span></span>
<span id="cb2-129"><a href="#cb2-129"></a>comp_micro_plot <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(complaints, def_micro)) <span class="sc">+</span></span>
<span id="cb2-130"><a href="#cb2-130"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> clrs[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb2-131"><a href="#cb2-131"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb2-132"><a href="#cb2-132"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-133"><a href="#cb2-133"></a>    <span class="at">color =</span> clrs[<span class="dv">5</span>],</span>
<span id="cb2-134"><a href="#cb2-134"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-135"><a href="#cb2-135"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-136"><a href="#cb2-136"></a>    <span class="at">x =</span> <span class="st">"complaints"</span>,</span>
<span id="cb2-137"><a href="#cb2-137"></a>    <span class="at">y =</span> <span class="st">"microchips"</span>) <span class="sc">+</span></span>
<span id="cb2-138"><a href="#cb2-138"></a>  <span class="fu">theme_nice_dist</span>() <span class="co"># Apply a custom theme</span></span>
<span id="cb2-139"><a href="#cb2-139"></a><span class="co"># Creating grid panel displaying all three plots vertically. </span></span>
<span id="cb2-140"><a href="#cb2-140"></a><span class="co"># I prefer the vertical plots rather than the horizontal ones</span></span>
<span id="cb2-141"><a href="#cb2-141"></a>arranged_plots <span class="ot">&lt;-</span> gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(dev_comp_plot, dev_micro_plot, comp_micro_plot, <span class="at">nrow =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2" title="Relationship between devices, complaints, and defective microchips"><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Relationship between devices, complaints, and defective microchips"></a></p>
<figcaption>Relationship between devices, complaints, and defective microchips</figcaption></figure>
</div>
</div></div></div>
</section><section id="additive-processes" class="level3 page-columns page-full"><h3 class="anchored">Additive processes</h3>
<p>A process <span class="math inline">\(Y\)</span> is considered additive when the value of each observation is determined by adding a variable quantity to the value of a previous observation. The process is characterized by an initial value <span class="math inline">\(Y(0)\)</span> and the increments <span class="math inline">\(Y_{i} - Y_{h}\)</span> with <span class="math inline">\(i &gt; h \geq 0\)</span>, where <span class="math inline">\(Y_{i}\)</span> represents the value of an observation at a certain point and <span class="math inline">\(Y_{h}\)</span>, the value of the subsequent observation. This additive process typically consists of three components.</p>
<ul>
<li><p>An initial value <span class="math inline">\(Y_{0}\)</span> that serves as the starting point of the process.</p></li>
<li><p>A random, slow, and gradual change component <span class="math inline">\(Y_{1}\)</span> around the central tendency represents the continuous evolution of the process over time.</p></li>
<li><p>A third random component <span class="math inline">\(Y_{2}\)</span>​ represents sudden jumps or changes in the process, which may occur unpredictably at certain time points.</p></li>
</ul>
<p>Together, these components contribute to the behavior of the <span class="math inline">\(Y\)</span>​ process and its evolution across time through a combination of unexpected slow changes and sudden jumps.</p>
<p>An example of such a random process in epidemiology is the <em>total number</em> of infections within a population over time. Initially, there’s a small number of infected (<em>I</em>) individuals that spread the disease across the susceptible population (<em>S</em>), and as the population grows and control measures take place, the evolution of the disease and the number of cases fluctuates. If a new variant of this disease was introduced, a sudden spike in the <em>total number</em> of infected individuals would also determine the evolution of the disease.</p>
<section id="are-processes-always-additive" class="level4 page-columns page-full"><h4 class="anchored">Are processes always additive?</h4>
<p>Unfortunately for us, not all processes are additive. Multiplicative processes are common in nature and sometimes we mistakenly assume additivity. Let’s clarify the difference between an additive and a multiplicative process.</p>
<div class="page-columns page-full"><p>A random process is considered multiplicative when the value of a variable <span class="math inline">\(Y_{t}\)</span> at each time step <em>multiplicatively</em> depends on the previous value <span class="math inline">\(Y_{t-1}\)</span> by a scaling factor <span class="math inline">\(r\)</span>. To get to the next observation, <span class="math inline">\(Y_{t}\)</span>, we have to multiply by <span class="math inline">\(r\)</span> instead of adding this random quantity to our initial value <span class="math inline">\(Y_{0}\)</span>.  The scaling factor <span class="math inline">\(r\)</span>​ changes with each observation as random variation is introduced.</p><div class="no-row-height column-margin column-container"><span class="margin-aside"><span class="math inline">\(Y_{t} = Y_{t-1} \cdot r \, | \, r = \nu(1 + \rho_{t})\)</span>, where <span class="math inline">\(\nu \geq 0\)</span> and the random component <span class="math inline">\(\rho_{t} \geq 0\)</span></span></div></div>
<ul>
<li><p>How we use CLT</p></li>
<li>
<p>How to know when empirical distribution converges to normal distribution?</p>
<h3 id="whats-the-deal-with-n-geq-30" class="anchored">what’s the deal with <span class="math inline">\(n \geq 30\)</span>?</h3>
<ul>
<li>
<p>Jacob Cohen (1991) mentioned that at least 30 observations were needed to use the critical-ratio approach used in t-tables when comparing groups. If the sample size is smaller than 30, then students would be forced to “small” sample statistics.</p>
<blockquote class="blockquote">
<p>It wasn’t until some years later that I discovered (mind you, not invented) power analysis, one of whose fruits was the revelation that for a two-independent-group-mean comparison with n = 30 per group at the sanctified two-tailed .05 level, the probability that a medium-sized effect would be labeled as significant by the most modern methods (a t-test) was only .47. Thus, it was approximately a coin flip whether one would get a significant result, even though, in reality, the effect size was meaningful.</p>
</blockquote>
<ul>
<li>
<p>Simply a rule of thumb that allowed students to use critical t–t-tables. These tables could only span 30 lines to fit in one page. Fisher created the</p>
<p>t-table and only went up to n = 30 (Fisher’s <em>Statistical Methods for Research Workers</em> (1925))</p>
</li>
<li><p>Sample size at least 30 so that the error variance between t–distribution and theoretical normal distribution is .25 or less from df = 30 up to infinity.</p></li>
<li><p>When data is severely skewed neither the t–test nor the permutation test have much power (are not robust) to correctly identify a statistically significance difference in means between too highly skewed distributions. Even if your data contained tens of thousands of observations, the t–test may not recognize a statistically significance difference in means. The distribution of the data and the number of observations need to be considered when deciding whether the t–test is meaningful and accurate, sometimes thousands of observations may be needed.</p></li>
</ul>
</li>
</ul>
<h2 id="solution" class="anchored" data-anchor-id="are-processes-always-additive">Solution</h2>
<ul>
<li>The number of observations needed for our distribution to approximate the standard normal curve will ultimately depend on our data, the question we’re seeking to answer, and the test we plan to use to arrive at our hypothesis.</li>
<li>Use power analysis to determine the sample size needed to obtain statistically significant results using your desired <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, and effect size measure. This way, you don’t have to assume</li>
</ul>
</li>
</ul>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Simulated identically distributed and non-identically distributed variables.</span>
<span class="glightbox-desc lightbox-desc-2">Relationship between devices, complaints, and defective microchips</span>
</div>
</section></section></section><div id="quarto-appendix"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-monteagudo2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Monteagudo, JP. 2024. <span>“What’s This CLT, Please? A Straightforward
Explanation of the Central Limit Theorem and the Magic ($n =30$) Sample
Size Requirements.”</span> March 6, 2024. <a href="https://doi.org/10.59350/bje88-8r592">https://doi.org/10.59350/bje88-8r592</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="jpmonteagudo28/Portfolio_quarto" data-repo-id="R_kgDOKnaxdQ" data-category="Blog comments" data-category-id="DIC_kwDOIg6EJc4CSz92" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb3" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="an">title:</span><span class="co"> "What's this CLT, please? A straightforward explanation of the Central Limit Theorem and the magic ($n =30$) sample size requirements"</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="an">date:</span><span class="co"> 2024-03-06</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="an">description:</span><span class="co"> "Shining a light on the Central Limit Theorem and the mythical sample size requirements for the health and social sciences"</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="an">categories:</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"> - r</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"> - clt</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"> - sample size</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"> - Lyndeberg-Lévy</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"> - Gaussian</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="an">format:</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">  html:</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">    css: styles.css</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">    code-fold: true</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">    code-tools: true</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">    highlight-style: tango</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="an">doi:</span><span class="co"> 10.59350/bje88-8r592</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">---</span></span>
<span id="cb3-22"><a href="#cb3-22"></a></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="in">knitr::opts_chunk$set(fig.align = "center", fig.retina = 3,</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="in">                      fig.width = 5.5, fig.height = (5.5 * 0.618),</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="in">                      out.width = "90%", collapse = TRUE)</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="in">options(digits = 3, width = 300)</span></span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="in">set.seed(09)</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="in">```</span></span>
<span id="cb3-31"><a href="#cb3-31"></a></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="fu">## The Central Limit Theorem</span></span>
<span id="cb3-33"><a href="#cb3-33"></a></span>
<span id="cb3-34"><a href="#cb3-34"></a>The rudiments of the Central Limit Theorem (CLT) can be traced back to Bernoulli, who famously penned: “even the stupidest person without any prior instruction knows that the more observations are made, the less danger there is of missing the target”, hinting at the notion that, as the number of trials increases, even a simpleton can eventually arrive at the expected outcome.</span>
<span id="cb3-35"><a href="#cb3-35"></a></span>
<span id="cb3-36"><a href="#cb3-36"></a>The theorem derives its name from the fact that we're using a parameter of *central* tendency – typically the mean, median, or mode– to arrive at the *limiting distribution* of independent random variables– which, under certain conditions, will typically be the standard normal distribution.</span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>To put it differently, by sampling a finite population an increasing number of times and using the mean of the $n$ samples as our metric, we will see how our histogram for the population of sampled means will conform to a standard normal curve. By estimating the limiting distribution– the beloved normal distribution– of our independent variables, the theorem helps us answer the question:</span>
<span id="cb3-39"><a href="#cb3-39"></a></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="at">&gt; If an outcome $p$ has occurred $p$ times out of $p + q = n$ number of trials, what's the probability of our desired outcome occurring $r$ times in a further $r + q = m$ number of trials?</span></span>
<span id="cb3-41"><a href="#cb3-41"></a></span>
<span id="cb3-42"><a href="#cb3-42"></a>Let's now talk about the **conditions** we must meet for our distribution to converge or arrive at the standard normal distribution with mean equal to zero and variance equal to 1.</span>
<span id="cb3-43"><a href="#cb3-43"></a></span>
<span id="cb3-44"><a href="#cb3-44"></a>::: column-margin</span>
<span id="cb3-45"><a href="#cb3-45"></a>I'll start referring to a standard normal distribution with mean equal to zero and variance equal to 1 by using the following notation $\mathcal{N}(0,1)$</span>
<span id="cb3-46"><a href="#cb3-46"></a>:::</span>
<span id="cb3-47"><a href="#cb3-47"></a></span>
<span id="cb3-48"><a href="#cb3-48"></a><span class="fu">### Random processes</span></span>
<span id="cb3-49"><a href="#cb3-49"></a></span>
<span id="cb3-50"><a href="#cb3-50"></a>The variables under study must be the outcome of a random phenomenon for which we know the type of outcomes that can happen but cannot know how or when they will occur. We can know some of the causes of this phenomenon, but their deviations from a supposed pattern are unknown to us.</span>
<span id="cb3-51"><a href="#cb3-51"></a></span>
<span id="cb3-52"><a href="#cb3-52"></a>A classic example of a random variable is a game of cards in which we know what the cards on the deck are but cannot tell which one will come up next– unless we cheat and then the whole thing is not a random phenomenon anymore. In the life and social sciences, we can find random variables everywhere: the height and weight of a population, hemoglobin levels in healthy adults, the number of patients in the ER on any given night, pH levels in different types of topsoil or the scores on the UCLA Loneliness scale. The common thread here is that one *random* observation doesn't provide information on the occurrence of the next one.</span>
<span id="cb3-53"><a href="#cb3-53"></a></span>
<span id="cb3-54"><a href="#cb3-54"></a><span class="fu">### Independence and identical distribution</span></span>
<span id="cb3-55"><a href="#cb3-55"></a></span>
<span id="cb3-56"><a href="#cb3-56"></a>In the life and social sciences, we'll typically see *conditional independence*, where variables $A$ and $B$ are measurements of the same underlying quantity $C$. We say that $A$ and $B$ are conditionally independent if, once C is known, the value of $B$ doesn't give new information about $A$. Knowing what happens to $B$ after $C$ takes place doesn't increase our chances of correctly predicting the outcome of $A$. In addition, independent variables are also uncorrelated – their covariance ($cov<span class="co">[</span><span class="ot">A,B</span><span class="co">]</span> = E<span class="co">[</span><span class="ot">A</span><span class="co">]</span>\cdot E<span class="co">[</span><span class="ot">B</span><span class="co">]</span>$) and Pearson's $r$ ($\rho_{X,Y} = \frac{cov<span class="co">[</span><span class="ot">A,B</span><span class="co">]</span>}{\sigma_{A}\sigma_{B}}$​) are equal to zero.</span>
<span id="cb3-57"><a href="#cb3-57"></a></span>
<span id="cb3-58"><a href="#cb3-58"></a><span class="in">```{r, eval = TRUE, attr.source= '.numberLines'}</span></span>
<span id="cb3-59"><a href="#cb3-59"></a><span class="in">#| label: fig_iid</span></span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="in">#| fig-cap: "Simulated identically distributed and non-identically distributed variables."</span></span>
<span id="cb3-61"><a href="#cb3-61"></a><span class="in">#| lightbox:</span></span>
<span id="cb3-62"><a href="#cb3-62"></a><span class="in">#| group: r-graph</span></span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="in">#| column: margin</span></span>
<span id="cb3-64"><a href="#cb3-64"></a></span>
<span id="cb3-65"><a href="#cb3-65"></a><span class="in">clrs &lt;- c( # Creating custom color palette</span></span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="in">  "#FFBE00", #  yellow</span></span>
<span id="cb3-67"><a href="#cb3-67"></a><span class="in">  "#B92F0A", #  red</span></span>
<span id="cb3-68"><a href="#cb3-68"></a><span class="in">  "#7C225C", #  purple</span></span>
<span id="cb3-69"><a href="#cb3-69"></a><span class="in">  "#792A26", #  brown</span></span>
<span id="cb3-70"><a href="#cb3-70"></a><span class="in">  "#242424", #  dark gray</span></span>
<span id="cb3-71"><a href="#cb3-71"></a><span class="in">  "#394DAA") #  blue</span></span>
<span id="cb3-72"><a href="#cb3-72"></a></span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="in">xx &lt;- seq(-5,5,by=.01) # Creating variable to use in dens. curve</span></span>
<span id="cb3-74"><a href="#cb3-74"></a><span class="in">## Plot graphics</span></span>
<span id="cb3-75"><a href="#cb3-75"></a><span class="in">par(las = 1, mfrow = c(1,3), mai = c(.5, .5, .5, .1))</span></span>
<span id="cb3-76"><a href="#cb3-76"></a><span class="in">## Plot graphics</span></span>
<span id="cb3-77"><a href="#cb3-77"></a><span class="in">plot(xx, dnorm(xx, -1),type = "b", lwd = 1, xlab = "", ylab = "",</span></span>
<span id="cb3-78"><a href="#cb3-78"></a><span class="in">  col = clrs[3], main = "Identically distributed")</span></span>
<span id="cb3-79"><a href="#cb3-79"></a><span class="in">lines(xx, dnorm(xx, -1), lty = 2, lwd = 3, pch = 18, col = clrs[1])</span></span>
<span id="cb3-80"><a href="#cb3-80"></a><span class="in">legend("topright",legend = c("A", "B"),</span></span>
<span id="cb3-81"><a href="#cb3-81"></a><span class="in">  col = c(clrs[3], clrs[1]), lty = 1:2, cex = 0.8)</span></span>
<span id="cb3-82"><a href="#cb3-82"></a><span class="in">## Plot graphics</span></span>
<span id="cb3-83"><a href="#cb3-83"></a><span class="in">plot(xx,dnorm(xx,-1),type="l",lwd=2,xlab="",ylab="",</span></span>
<span id="cb3-84"><a href="#cb3-84"></a><span class="in">     col = clrs[3],main="Shift in means")</span></span>
<span id="cb3-85"><a href="#cb3-85"></a><span class="in">lines(xx,dnorm(xx,1),lty = 2, lwd=3,pch = 18,col= clrs[1])</span></span>
<span id="cb3-86"><a href="#cb3-86"></a><span class="in">legend("topright", legend = c("A", "B"),</span></span>
<span id="cb3-87"><a href="#cb3-87"></a><span class="in">       col = c(clrs[3], clrs[1]), lty = 1:2, cex = 0.8)</span></span>
<span id="cb3-88"><a href="#cb3-88"></a><span class="in">## Plot graphics</span></span>
<span id="cb3-89"><a href="#cb3-89"></a><span class="in">plot(xx,dnorm(xx,-1),type="l",lwd=2,xlab="",ylab="",</span></span>
<span id="cb3-90"><a href="#cb3-90"></a><span class="in">     col = clrs[3], main = "Different distributions", ylim = c(0, 0.6))</span></span>
<span id="cb3-91"><a href="#cb3-91"></a><span class="in">lines(xx, dchisq(xx, 2), lwd = 2, col = clrs[1])</span></span>
<span id="cb3-92"><a href="#cb3-92"></a><span class="in">legend("topright", legend = c("A", "B"),</span></span>
<span id="cb3-93"><a href="#cb3-93"></a><span class="in">       col = c(clrs[3], clrs[1]), lty = 1:2, cex = 0.8)</span></span>
<span id="cb3-94"><a href="#cb3-94"></a><span class="in">```</span></span>
<span id="cb3-95"><a href="#cb3-95"></a></span>
<span id="cb3-96"><a href="#cb3-96"></a>Additionally, two variables $A_{n}$ and $B_{n}$ are identically distributed when their probability distributions match exactly, and their means and variances ($\mu_{A} = \mu_{B}, \sigma_{A}^2 = \sigma_{B}^2$​​​) are equal. By now you can already see how this assumption can at best be approximated and almost impossible to demonstrate by the variables commonly studied in the life and social sciences.</span>
<span id="cb3-97"><a href="#cb3-97"></a></span>
<span id="cb3-98"><a href="#cb3-98"></a>Let's look at a hypothetical example of conditional independence:</span>
<span id="cb3-99"><a href="#cb3-99"></a></span>
<span id="cb3-100"><a href="#cb3-100"></a>Let's say a microchip manufacturer records the weekly number of defective microchips (<span class="in">`def_micros`</span>) for each of its 8–hour shifts to evaluate whether the number of complaints (<span class="in">`complaints`</span>) received in 24 hours is related to <span class="in">`def_micro`</span>. They also want to know if the number of complaints given <span class="in">`def_micro`</span> is related to the number of devices (<span class="in">`devices`</span>) bought and returned through their online retailer. . To answer this question, we first need to determine that <span class="in">`complaints`</span> and <span class="in">`devices`</span> are conditionally independent if, each variable is associated with<span class="in">`def_micr0`</span>, but their <span class="co">[</span><span class="ot">partial correlation</span><span class="co">](https://en.wikipedia.org/wiki/Partial_correlation)</span> coefficient is close to zero. We then calculate the zero-order correlation and compare it to the first–order correlation given the number of defective microchips. In our example, the zero-order correlation between devices and complaints is $\rho = .099$ and the first–order correlation is technically non-existent $\rho = -.021$, and we can assume <span class="in">`devices`</span> and <span class="in">`complaints`</span> are conditionally independent.</span>
<span id="cb3-101"><a href="#cb3-101"></a></span>
<span id="cb3-102"><a href="#cb3-102"></a><span class="in">```{r, eval = TRUE, warning = FALSE, message = FALSE, attr.source= '.numberLines'}</span></span>
<span id="cb3-103"><a href="#cb3-103"></a><span class="in">#| fig-cap-label: cond_ind</span></span>
<span id="cb3-104"><a href="#cb3-104"></a><span class="in">#| fig-cap: "Relationship between devices, complaints, and defective microchips"</span></span>
<span id="cb3-105"><a href="#cb3-105"></a><span class="in">#| lightbox:</span></span>
<span id="cb3-106"><a href="#cb3-106"></a><span class="in">#| group: r-graph</span></span>
<span id="cb3-107"><a href="#cb3-107"></a><span class="in">#| column: margin</span></span>
<span id="cb3-108"><a href="#cb3-108"></a></span>
<span id="cb3-109"><a href="#cb3-109"></a><span class="in">##---------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-110"><a href="#cb3-110"></a><span class="in">## Generating two random variables that meet the i.i.d assumption</span></span>
<span id="cb3-111"><a href="#cb3-111"></a><span class="in">## --------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-112"><a href="#cb3-112"></a><span class="in">library(here)</span></span>
<span id="cb3-113"><a href="#cb3-113"></a><span class="in">library(ppcor)</span></span>
<span id="cb3-114"><a href="#cb3-114"></a><span class="in">library(ggplot2)</span></span>
<span id="cb3-115"><a href="#cb3-115"></a><span class="in">library(gridExtra)</span></span>
<span id="cb3-116"><a href="#cb3-116"></a><span class="in">library(showtext)</span></span>
<span id="cb3-117"><a href="#cb3-117"></a><span class="in">library(knitr)</span></span>
<span id="cb3-118"><a href="#cb3-118"></a><span class="in">##------------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-119"><a href="#cb3-119"></a><span class="in">## Generating two conditionally independent random variables</span></span>
<span id="cb3-120"><a href="#cb3-120"></a><span class="in">## ------------------------------------------------------------------------------------ ##</span></span>
<span id="cb3-121"><a href="#cb3-121"></a><span class="in">## Creating function to generate random variable with defined correlation to an existing var.</span></span>
<span id="cb3-122"><a href="#cb3-122"></a><span class="in">complement &lt;- function(y, rho, x) { # corr. coefficient</span></span>
<span id="cb3-123"><a href="#cb3-123"></a><span class="in">  if (missing(x)) x &lt;- rgamma(length(y), 2, .5) # Optional: supply a default if `x` is not given</span></span>
<span id="cb3-124"><a href="#cb3-124"></a><span class="in">  y.perp &lt;- residuals(lm(x ~ y))</span></span>
<span id="cb3-125"><a href="#cb3-125"></a><span class="in">  rho * sd(y.perp) * y + y.perp * sd(y) * sqrt(1 - rho^2)</span></span>
<span id="cb3-126"><a href="#cb3-126"></a><span class="in">}</span></span>
<span id="cb3-127"><a href="#cb3-127"></a><span class="in">def_micro &lt;- rpois(1050, 6) # lambda = n*p, p = .006 defective microchips </span></span>
<span id="cb3-128"><a href="#cb3-128"></a><span class="in">complaints &lt;- complement(def_micro, rho = .273) # no. complaints received on 24 hr period </span></span>
<span id="cb3-129"><a href="#cb3-129"></a><span class="in">devices &lt;- complement(def_micro, rho = .331) # weekly no. devices processed at online retailer</span></span>
<span id="cb3-130"><a href="#cb3-130"></a></span>
<span id="cb3-131"><a href="#cb3-131"></a><span class="in">## Creating function to summarize list of variables</span></span>
<span id="cb3-132"><a href="#cb3-132"></a><span class="in">group_summary &lt;- function(...) {</span></span>
<span id="cb3-133"><a href="#cb3-133"></a><span class="in">  summaries &lt;- lapply(list(...), summary)</span></span>
<span id="cb3-134"><a href="#cb3-134"></a><span class="in">  names(summaries) &lt;- paste0("Summary_", seq_along(summaries))</span></span>
<span id="cb3-135"><a href="#cb3-135"></a><span class="in">  return(summaries)</span></span>
<span id="cb3-136"><a href="#cb3-136"></a><span class="in">}</span></span>
<span id="cb3-137"><a href="#cb3-137"></a></span>
<span id="cb3-138"><a href="#cb3-138"></a><span class="in">group_summary(def_micro, devices, complaints)</span></span>
<span id="cb3-139"><a href="#cb3-139"></a><span class="in">## ------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-140"><a href="#cb3-140"></a><span class="in">## Creating function to find Spearman's rho among all variables</span></span>
<span id="cb3-141"><a href="#cb3-141"></a><span class="in">## ------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-142"><a href="#cb3-142"></a><span class="in">spearman_correlation &lt;- function(...) {</span></span>
<span id="cb3-143"><a href="#cb3-143"></a><span class="in">  df &lt;- data.frame(...)</span></span>
<span id="cb3-144"><a href="#cb3-144"></a><span class="in">  correlation_matrix &lt;- round(cor(df, method = "spearman"), 3)</span></span>
<span id="cb3-145"><a href="#cb3-145"></a><span class="in">  return(correlation_matrix)</span></span>
<span id="cb3-146"><a href="#cb3-146"></a><span class="in">}</span></span>
<span id="cb3-147"><a href="#cb3-147"></a><span class="in">spearman &lt;- spearman_correlation(def_micro, devices, complaints)</span></span>
<span id="cb3-148"><a href="#cb3-148"></a><span class="in">##</span></span>
<span id="cb3-149"><a href="#cb3-149"></a><span class="in">##              def_micro devices complaints</span></span>
<span id="cb3-150"><a href="#cb3-150"></a><span class="in">## def_micro      1.000   0.378      0.297</span></span>
<span id="cb3-151"><a href="#cb3-151"></a><span class="in">## devices        0.378   1.000      0.099</span></span>
<span id="cb3-152"><a href="#cb3-152"></a><span class="in">## complaints     0.297   0.099      1.000</span></span>
<span id="cb3-153"><a href="#cb3-153"></a></span>
<span id="cb3-154"><a href="#cb3-154"></a></span>
<span id="cb3-155"><a href="#cb3-155"></a><span class="in">## Use ppcor package to calculate partial correlation between complaints and devices</span></span>
<span id="cb3-156"><a href="#cb3-156"></a><span class="in">part_cor &lt;- ppcor::pcor.test(devices, complaints, def_micro, method = "spearman")</span></span>
<span id="cb3-157"><a href="#cb3-157"></a><span class="in">##      estimate  p.value  statistic  n gp   Method</span></span>
<span id="cb3-158"><a href="#cb3-158"></a><span class="in">##  -0.02075897 0.501827 -0.6718506 1050  1 spearman</span></span>
<span id="cb3-159"><a href="#cb3-159"></a><span class="in">## Relationship between devices and complaints is technically non-existent.</span></span>
<span id="cb3-160"><a href="#cb3-160"></a><span class="in">## We can say they're conditionally independent.</span></span>
<span id="cb3-161"><a href="#cb3-161"></a><span class="in">## -------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-162"><a href="#cb3-162"></a><span class="in">## Creating scatterplots to visualize relationship between variables</span></span>
<span id="cb3-163"><a href="#cb3-163"></a><span class="in">## -------------------------------------------------------------------------------- ##</span></span>
<span id="cb3-164"><a href="#cb3-164"></a><span class="in"># Custom ggplot theme to make nicer plots</span></span>
<span id="cb3-165"><a href="#cb3-165"></a><span class="in"># Get the font at https://fonts.google.com/specimen/Fira+Sans+Condensed</span></span>
<span id="cb3-166"><a href="#cb3-166"></a><span class="in">font_add_google("Fira Sans")</span></span>
<span id="cb3-167"><a href="#cb3-167"></a><span class="in">showtext_auto()</span></span>
<span id="cb3-168"><a href="#cb3-168"></a><span class="in">theme_nice &lt;- function() {</span></span>
<span id="cb3-169"><a href="#cb3-169"></a><span class="in">  theme_minimal(base_family = "Fira Sans Condensed") +</span></span>
<span id="cb3-170"><a href="#cb3-170"></a><span class="in">    theme(</span></span>
<span id="cb3-171"><a href="#cb3-171"></a><span class="in">      panel.grid.minor = element_blank(),</span></span>
<span id="cb3-172"><a href="#cb3-172"></a><span class="in">      plot.title = element_text(family = "Fira Sans Condensed Bold", face = "plain", size = rel(1.35)),</span></span>
<span id="cb3-173"><a href="#cb3-173"></a><span class="in">      plot.subtitle = element_text(family = "Fira Sans Condensed Medium", face = "plain", size = rel(1.2)),</span></span>
<span id="cb3-174"><a href="#cb3-174"></a><span class="in">      axis.title = element_text(family = "Fira Sans Condensed SemiBold", face = "plain", size = rel(1)),</span></span>
<span id="cb3-175"><a href="#cb3-175"></a><span class="in">      axis.title.x = element_text(hjust = 0),</span></span>
<span id="cb3-176"><a href="#cb3-176"></a><span class="in">      axis.title.y = element_text(hjust = 1),</span></span>
<span id="cb3-177"><a href="#cb3-177"></a><span class="in">      axis.text = element_text(family = "Fira Sans Condensed Light", face = "plain", size = rel(0.8)),</span></span>
<span id="cb3-178"><a href="#cb3-178"></a><span class="in">      strip.text = element_text(</span></span>
<span id="cb3-179"><a href="#cb3-179"></a><span class="in">        family = "Fira Sans Condensed", face = "bold",</span></span>
<span id="cb3-180"><a href="#cb3-180"></a><span class="in">        size = rel(1), hjust = 0</span></span>
<span id="cb3-181"><a href="#cb3-181"></a><span class="in">      ),</span></span>
<span id="cb3-182"><a href="#cb3-182"></a><span class="in">      strip.background = element_rect(fill = "grey95", color = NA)</span></span>
<span id="cb3-183"><a href="#cb3-183"></a><span class="in">    )</span></span>
<span id="cb3-184"><a href="#cb3-184"></a><span class="in">}</span></span>
<span id="cb3-185"><a href="#cb3-185"></a></span>
<span id="cb3-186"><a href="#cb3-186"></a><span class="in">theme_nice_dist &lt;- function() {</span></span>
<span id="cb3-187"><a href="#cb3-187"></a><span class="in">  theme_nice() +</span></span>
<span id="cb3-188"><a href="#cb3-188"></a><span class="in">    theme(</span></span>
<span id="cb3-189"><a href="#cb3-189"></a><span class="in">      panel.grid = element_blank(),</span></span>
<span id="cb3-190"><a href="#cb3-190"></a><span class="in">      panel.spacing.x = unit(10, units = "pt"),</span></span>
<span id="cb3-191"><a href="#cb3-191"></a><span class="in">      axis.ticks.x = element_line(linewidth = 0.25),</span></span>
<span id="cb3-192"><a href="#cb3-192"></a><span class="in">      axis.text.y = element_blank()</span></span>
<span id="cb3-193"><a href="#cb3-193"></a><span class="in">    )</span></span>
<span id="cb3-194"><a href="#cb3-194"></a><span class="in">}</span></span>
<span id="cb3-195"><a href="#cb3-195"></a></span>
<span id="cb3-196"><a href="#cb3-196"></a><span class="in">theme_set(theme_nice())</span></span>
<span id="cb3-197"><a href="#cb3-197"></a></span>
<span id="cb3-198"><a href="#cb3-198"></a><span class="in">ggplot2::update_geom_defaults("label", list(family = "Fira Sans Condensed SemiBold", fontface = "plain"))</span></span>
<span id="cb3-199"><a href="#cb3-199"></a><span class="in">ggplot2::update_geom_defaults("text", list(family = "Fira Sans Condensed SemiBold", fontface = "plain"))</span></span>
<span id="cb3-200"><a href="#cb3-200"></a></span>
<span id="cb3-201"><a href="#cb3-201"></a><span class="in"># Making df with previously created variables</span></span>
<span id="cb3-202"><a href="#cb3-202"></a><span class="in">df1 &lt;- data.frame(def_micro, devices, complaints)</span></span>
<span id="cb3-203"><a href="#cb3-203"></a><span class="in"># Making plot to show correlation between devices v. complaints.</span></span>
<span id="cb3-204"><a href="#cb3-204"></a><span class="in">dev_comp_plot &lt;- ggplot2::ggplot(df1, aes(devices, complaints)) +</span></span>
<span id="cb3-205"><a href="#cb3-205"></a><span class="in">  geom_point(color = clrs[2]) +</span></span>
<span id="cb3-206"><a href="#cb3-206"></a><span class="in">  geom_smooth(method = "glm", # Use either glm or gam models</span></span>
<span id="cb3-207"><a href="#cb3-207"></a><span class="in">    se = FALSE,</span></span>
<span id="cb3-208"><a href="#cb3-208"></a><span class="in">    color = clrs[5],</span></span>
<span id="cb3-209"><a href="#cb3-209"></a><span class="in">    linewidth = 1) +</span></span>
<span id="cb3-210"><a href="#cb3-210"></a><span class="in">  labs(</span></span>
<span id="cb3-211"><a href="#cb3-211"></a><span class="in">    x = "devices",</span></span>
<span id="cb3-212"><a href="#cb3-212"></a><span class="in">    y = "complaints") +</span></span>
<span id="cb3-213"><a href="#cb3-213"></a><span class="in">  theme_nice_dist() # Apply a custom theme</span></span>
<span id="cb3-214"><a href="#cb3-214"></a><span class="in"># Making plot to show correlation between devices v. microchips</span></span>
<span id="cb3-215"><a href="#cb3-215"></a><span class="in">dev_micro_plot &lt;- ggplot2::ggplot(df1, aes(devices, def_micro)) +</span></span>
<span id="cb3-216"><a href="#cb3-216"></a><span class="in">  geom_point(color = clrs[3]) +</span></span>
<span id="cb3-217"><a href="#cb3-217"></a><span class="in">  geom_smooth(method = "lm",</span></span>
<span id="cb3-218"><a href="#cb3-218"></a><span class="in">    se = FALSE,</span></span>
<span id="cb3-219"><a href="#cb3-219"></a><span class="in">    color = clrs[5],</span></span>
<span id="cb3-220"><a href="#cb3-220"></a><span class="in">    linewidth = 1) +</span></span>
<span id="cb3-221"><a href="#cb3-221"></a><span class="in">  labs(</span></span>
<span id="cb3-222"><a href="#cb3-222"></a><span class="in">    x = "devices",</span></span>
<span id="cb3-223"><a href="#cb3-223"></a><span class="in">    y = "microchips") +</span></span>
<span id="cb3-224"><a href="#cb3-224"></a><span class="in">  theme_nice_dist() # Apply a custom theme</span></span>
<span id="cb3-225"><a href="#cb3-225"></a><span class="in"># Making plot to show correlation between complaints v. microchips</span></span>
<span id="cb3-226"><a href="#cb3-226"></a><span class="in">comp_micro_plot &lt;- ggplot2::ggplot(df1, aes(complaints, def_micro)) +</span></span>
<span id="cb3-227"><a href="#cb3-227"></a><span class="in">  geom_point(color = clrs[6]) +</span></span>
<span id="cb3-228"><a href="#cb3-228"></a><span class="in">  geom_smooth(method = "lm",</span></span>
<span id="cb3-229"><a href="#cb3-229"></a><span class="in">    se = FALSE,</span></span>
<span id="cb3-230"><a href="#cb3-230"></a><span class="in">    color = clrs[5],</span></span>
<span id="cb3-231"><a href="#cb3-231"></a><span class="in">    linewidth = 1) +</span></span>
<span id="cb3-232"><a href="#cb3-232"></a><span class="in">  labs(</span></span>
<span id="cb3-233"><a href="#cb3-233"></a><span class="in">    x = "complaints",</span></span>
<span id="cb3-234"><a href="#cb3-234"></a><span class="in">    y = "microchips") +</span></span>
<span id="cb3-235"><a href="#cb3-235"></a><span class="in">  theme_nice_dist() # Apply a custom theme</span></span>
<span id="cb3-236"><a href="#cb3-236"></a><span class="in"># Creating grid panel displaying all three plots vertically. </span></span>
<span id="cb3-237"><a href="#cb3-237"></a><span class="in"># I prefer the vertical plots rather than the horizontal ones</span></span>
<span id="cb3-238"><a href="#cb3-238"></a><span class="in">arranged_plots &lt;- gridExtra::grid.arrange(dev_comp_plot, dev_micro_plot, comp_micro_plot, nrow = 1) </span></span>
<span id="cb3-239"><a href="#cb3-239"></a></span>
<span id="cb3-240"><a href="#cb3-240"></a><span class="in">```</span></span>
<span id="cb3-241"><a href="#cb3-241"></a></span>
<span id="cb3-242"><a href="#cb3-242"></a><span class="fu">### Additive processes</span></span>
<span id="cb3-243"><a href="#cb3-243"></a></span>
<span id="cb3-244"><a href="#cb3-244"></a>A process $Y$ is considered additive when the value of each observation is determined by adding a variable quantity to the value of a previous observation. The process is characterized by an initial value $Y(0)$ and the increments $Y_{i} - Y_{h}$ with $i &gt; h \geq 0$, where $Y_{i}$ represents the value of an observation at a certain point and $Y_{h}$, the value of the subsequent observation. This additive process typically consists of three components.</span>
<span id="cb3-245"><a href="#cb3-245"></a></span>
<span id="cb3-246"><a href="#cb3-246"></a><span class="ss">-   </span>An initial value $Y_{0}$ that serves as the starting point of the process.</span>
<span id="cb3-247"><a href="#cb3-247"></a></span>
<span id="cb3-248"><a href="#cb3-248"></a><span class="ss">-   </span>A random, slow, and gradual change component $Y_{1}$ around the central tendency represents the continuous evolution of the process over time.</span>
<span id="cb3-249"><a href="#cb3-249"></a></span>
<span id="cb3-250"><a href="#cb3-250"></a><span class="ss">-   </span>A third random component $Y_{2}$​ represents sudden jumps or changes in the process, which may occur unpredictably at certain time points.</span>
<span id="cb3-251"><a href="#cb3-251"></a></span>
<span id="cb3-252"><a href="#cb3-252"></a>Together, these components contribute to the behavior of the $Y$​ process and its evolution across time through a combination of unexpected slow changes and sudden jumps.</span>
<span id="cb3-253"><a href="#cb3-253"></a></span>
<span id="cb3-254"><a href="#cb3-254"></a>An example of such a random process in epidemiology is the *total number* of infections within a population over time. Initially, there's a small number of infected (*I*) individuals that spread the disease across the susceptible population (*S*), and as the population grows and control measures take place, the evolution of the disease and the number of cases fluctuates. If a new variant of this disease was introduced, a sudden spike in the *total number* of infected individuals would also determine the evolution of the disease.</span>
<span id="cb3-255"><a href="#cb3-255"></a></span>
<span id="cb3-256"><a href="#cb3-256"></a><span class="fu">#### Are processes always additive?</span></span>
<span id="cb3-257"><a href="#cb3-257"></a></span>
<span id="cb3-258"><a href="#cb3-258"></a>Unfortunately for us, not all processes are additive. Multiplicative processes are common in nature and sometimes we mistakenly assume additivity. Let's clarify the difference between an additive and a multiplicative process.</span>
<span id="cb3-259"><a href="#cb3-259"></a></span>
<span id="cb3-260"><a href="#cb3-260"></a>A random process is considered multiplicative when the value of a variable $Y_{t}$ at each time step *multiplicatively* depends on the previous value $Y_{t-1}$ by a scaling factor $r$. To get to the next observation, $Y_{t}$, we have to multiply by $r$ instead of adding this random quantity to our initial value $Y_{0}$. <span class="co">[</span><span class="ot">$Y_{t} = Y_{t-1} \cdot r \, | \, r = \nu(1 + \rho_{t})$, where $\nu \geq 0$ and the random component $\rho_{t} \geq 0$</span><span class="co">]</span>{.aside} The scaling factor $r$​ changes with each observation as random variation is introduced.</span>
<span id="cb3-261"><a href="#cb3-261"></a></span>
<span id="cb3-262"><a href="#cb3-262"></a><span class="ss">-   </span>How we use CLT</span>
<span id="cb3-263"><a href="#cb3-263"></a></span>
<span id="cb3-264"><a href="#cb3-264"></a><span class="ss">-   </span>How to know when empirical distribution converges to normal distribution?</span>
<span id="cb3-265"><a href="#cb3-265"></a></span>
<span id="cb3-266"><a href="#cb3-266"></a>    ### What's the deal with $n \geq 30$?</span>
<span id="cb3-267"><a href="#cb3-267"></a></span>
<span id="cb3-268"><a href="#cb3-268"></a><span class="ss">    -   </span>Jacob Cohen (1991) mentioned that at least 30 observations were needed to use the critical-ratio approach used in t-tables when comparing groups. If the sample size is smaller than 30, then students would be forced to “small” sample statistics.</span>
<span id="cb3-269"><a href="#cb3-269"></a></span>
<span id="cb3-270"><a href="#cb3-270"></a><span class="at">        &gt; It wasn't until some years later that I discovered (mind you, not invented) power analysis, one of whose fruits was the revelation that for a two-independent-group-mean comparison with n = 30 per group at the sanctified two-tailed .05 level, the probability that a medium-sized effect would be labeled as significant by the most modern methods (a t-test) was only .47. Thus, it was approximately a coin flip whether one would get a significant result, even though, in reality, the effect size was meaningful.</span></span>
<span id="cb3-271"><a href="#cb3-271"></a></span>
<span id="cb3-272"><a href="#cb3-272"></a><span class="ss">        -   </span>Simply a rule of thumb that allowed students to use critical t–t-tables. These tables could only span 30 lines to fit in one page. Fisher created the t-table and only went up to n = 30 (Fisher's *Statistical Methods for Research Workers* (1925))</span>
<span id="cb3-273"><a href="#cb3-273"></a></span>
<span id="cb3-274"><a href="#cb3-274"></a><span class="ss">        -   </span>Sample size at least 30 so that the error variance between t–distribution and theoretical normal distribution is .25 or less from df = 30 up to infinity.</span>
<span id="cb3-275"><a href="#cb3-275"></a></span>
<span id="cb3-276"><a href="#cb3-276"></a><span class="ss">        -   </span>When data is severely skewed neither the t–test nor the permutation test have much power (are not robust) to correctly identify a statistically significance difference in means between too highly skewed distributions. Even if your data contained tens of thousands of observations, the t–test may not recognize a statistically significance difference in means. The distribution of the data and the number of observations need to be considered when deciding whether the t–test is meaningful and accurate, sometimes thousands of observations may be needed.</span>
<span id="cb3-277"><a href="#cb3-277"></a></span>
<span id="cb3-278"><a href="#cb3-278"></a>    ## Solution</span>
<span id="cb3-279"><a href="#cb3-279"></a></span>
<span id="cb3-280"><a href="#cb3-280"></a><span class="in">    -   The number of observations needed for our distribution to approximate the standard normal curve will ultimately depend on our data, the question we're seeking to answer, and the test we plan to use to arrive at our hypothesis.</span></span>
<span id="cb3-281"><a href="#cb3-281"></a><span class="in">    -   Use power analysis to determine the sample size needed to obtain statistically significant results using your desired $\alpha$, $\beta$, and effect size measure. This way, you don't have to assume</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2023–2024 JP Monteagudo</span> <span class="faux-block">All content licensed under<br><a href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-sa" aria-label="creative-commons-sa"></i> Creative Commons CC BY-SA 4.0</a></span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block"><i class="fa-brands fa-orcid" aria-label="orcid"></i> <strong>ORCID</strong> <a href="https://orcid.org/0009-0003-6465-6658">0009-0003-6465-6658</a></span> <span class="faux-block"><i class="fa-solid fa-key" aria-label="key"></i> <a href="../../../../pgp_jpm.asc.txt">PGP public key</a>   <i class="fa-solid fa-fingerprint" aria-label="fingerprint"></i> Fingerprint:<br><span class="fingerprint">6F8E F16C D290 19CE C37C<br> 1C80 0D8D 4F29 935E C085</span></span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a></span> <span class="faux-block"><a href="https://github.com/jpmonteagudo28/Portfolio_quarto">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></span></p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"descPosition":"bottom","closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>