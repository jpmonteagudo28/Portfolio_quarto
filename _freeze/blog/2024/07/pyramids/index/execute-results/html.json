{
  "hash": "3410e4082cc374e6fdcef94e7c1d7683",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"charting state demographics\"\ndate: now\ndescription: \"virginia population pyramids\"\nformat:\n  html:\n    css: styles.css\n    code-fold: false\n    code-tools: true\n    code-overflow: wrap\n    code-line-numbers: false\nresources:\n  - \"VA_pop_demo_data.txt\"\n  - \"cuba_95.txt\"\n  - \"cuba_22.txt\"\n  - \"un_cuba.txt\"\n#doi: \ncitation: true\ndraft: true\n---\n\n\n\n\n## consider everything that grows\n:::{.callout-note}\nMost of the headings are taken from the verses of Shakespeare's [Sonnet 15](https://www.poetryfoundation.org/poems/45086/sonnet-15-when-i-consider-everything-that-grows)\n:::\n\nPopulation pyramids paint a picture of the growth and “health” of a country, its states down to its counties. I came across the pyramids in one of my geography classes while living in Cuba. I thought they were pretty cool because I was obsessed with history^[especially Ancient Egypt, the Bible, and the Roman Empire.], thought they were connected to Ancient Egypt, and I could actually see how human movement into and out of existence affected my society and the economy in a very real sense. If the person who sold rice, sugar, flour, meat, or eggs, passed away, well now you have to go without it or find someone else who, taking advantage of the new vacancy, will jack up the prices. My generation saw a considerable decline in the number of children. We just simply didn't have the means to feed and keep multiple kids. Senior citizens, likewise, weren't many because we lacked the resources to effectively deal with naturally-occurring diseases and ailments in the elderly population. Most of my grandparents lived to be 90+, but they were the exception. I could clearly see all of this in the population pyramid of my generation.\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ncu_path <- here::here(\"data/cuba_95.txt\")\ncuba_95 <- read.delim(cu_path, sep = \"\")|>\n  pivot_longer(cols = c(M,F),\n                                      names_to = \"gender\",\n                                      values_to = \"population\") |>\n  mutate(gender = case_when(gender == \"M\" ~ \"Male\",\n                            gender == \"F\" ~ \"Female\"),\n         total = sum(population),\n         percent = population/total,\n         Age = fct_inorder(Age)) |>\n  mutate(percent = if_else(gender == \"Female\", percent, -percent)) |>\n  group_by(gender)\n\ncu_male95 <- cuba_95 |> filter(gender == \"Male\") |>\n  ggplot(aes(percent,Age)) +\n  geom_col(fill = va_clrs[1]) +\n  annotate(geom = \"label\",\n           family = \"Franklin Gothic Medium\",\n           x = -0.05,\n           y = 17,\n           label = \"Men\",\n           fill = va_clrs[3],\n           color = \"white\",\n           label.size = 0,\n           label.padding = unit(0.3,\"lines\")) +\n  scale_x_continuous(\n    labels = function(x) label_percent(accuracy = 1)(abs(x)),\n    limits = c(-0.06,0)\n  )\n\ncu_female95 <- cuba_95 |> filter(gender == \"Female\") |>\n  ggplot(aes(percent,Age)) +\n  geom_col(fill = va_clrs[3]) +\n  annotate(geom = \"label\",\n           family = \"Franklin Gothic Medium\",\n           x = 0.05,\n           y = 17,\n           label = \"Women\",\n           fill = va_clrs[5],\n           color = \"gray30\",\n           label.size = 0,\n           label.padding = unit(0.3, \"lines\")) +\n  scale_x_continuous(\n    labels = function(x) label_percent(accuracy = 1)(abs(x)),\n    limits = c(0,0.06)\n  )\n\nage_labels <- tibble( age = c( \"0-4\",\"5-9\",\"10-14\",\n      \"15-19\", \"20-24\",\"25-29\",\n      \"30-34\",\"35-39\",\"40-44\",\n      \"45-49\", \"50-54\", \"55-59\",\n      \"60-64\",\"65-69\", \"70-74\",\n      \"75-79\",\"80-84\", \"85-89\",\n      \"90+\" )) |>\n  mutate(age = fct_inorder(age)) \n\nage_plot <- age_labels |>\n  ggplot(aes(x = 1,y = age, label = age)) +\n  geom_text(family = \"Franklin Gothic Medium\", size = 4.5) +\n  theme_void()\n\ncu_male95 +\n  age_plot +\ncu_female95 +\n  plot_layout(widths = c(7.5,1,7.5))\n  \n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/cu95_pop.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nbase_path <- here::here(\"data/Va_pop_demo_data.txt\")\nva_demo_dat <- read.delim(base_path, sep = \"\\t\")\nva_demo_dat <- va_demo_dat |> \n  mutate(age_range = paste(Starting.Age, Ending.Age, \n                            sep = \"-\")) |>\n  mutate(gender = as.factor(Gender))|>\n  group_by(Year,gender) |>\n  mutate(percent = Total_Population / sum(Total_Population)) |>\n  mutate(percent = if_else(gender == \"Female\", percent, -percent))|>\n  select(-Starting.Age, -Ending.Age, -ID_Gender,\n         -ID_Geography,-Slug_Geography, -Gender)\n\nglimpse(va_demo_dat)\n\nva_men_2022 <- va_demo_dat |>\n  filter(Year == 2022) |>\n  filter(gender == \"Male\") |>\n  ggplot(aes(percent,age_range)) +\n  geom_col(fill = va_clrs[3]) +\n  annotate(geom = \"label\",\n           family = \"Franklin Gothic Medium\",\n           x = -0.05,\n           y = 17,\n           label = \"Men\",\n           fill = va_clrs[3],\n           color = \"white\",\n           label.size = 0,\n           label.padding = unit(0.3,\"lines\")) +\n  scale_x_continuous(\n    labels = function(x) label_percent(accuracy = 1)(abs(x)),\n    limits = c(-0.08,0)\n  )\n  \n\nva_women_2022 <- va_demo_dat |>\n  filter(Year == 2022) |>\n  filter(gender == \"Female\") |>\n  ggplot(aes(percent,age_range)) +\n  geom_col(fill = va_clrs[5]) +\n  annotate(geom = \"label\",\n           family = \"Franklin Gothic Medium\",\n           x = 0.05,\n           y = 17,\n           label = \"Women\",\n           fill = va_clrs[6],\n           color = \"gray30\",\n           label.size = 0,\n           label.padding = unit(0.3, \"lines\")) +\n  scale_x_continuous(\n    labels = function(x) label_percent(accuracy = 1)(abs(x)),\n    limits = c(0,0.08)\n  )\n\nva_men_2022 +\n  age_plot +\n  va_women_2022 +\n  plot_layout(widths = c(7.5,1,7.5))\n```\n:::\n\n::: {.cell layout-align=\"center\" lightbox='true'}\n::: {.cell-output-display}\n![](img/va22_pop.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\ncu_22 <- here::here(\"data/cuba_22.txt\")\ncu_22 <- read.delim(cu_22,sep = \"\") \ncuba_22 <- cu_22 |>\n  pivot_longer(cols = c(M,F),\n                                      names_to = \"gender\",\n                                      values_to = \"population\") |>\n  mutate(gender = case_when(gender == \"M\" ~ \"Male\",\n                            gender == \"F\" ~ \"Female\"),\n         total = sum(population),\n         percent = population/total,\n         Age = fct_inorder(Age)) |>\n  mutate(percent = if_else(gender == \"Female\", percent, -percent)) |>\n  group_by(gender)\n\ncu_male22 <- cuba_22 |> filter(gender == \"Male\") |>\n  ggplot(aes(percent,Age)) +\n  geom_col(fill = va_clrs[1]) +\n  annotate(geom = \"label\",\n           family = \"Franklin Gothic Medium\",\n           x = -0.05,\n           y = 17,\n           label = \"Men\",\n           fill = va_clrs[3],\n           color = \"white\",\n           label.size = 0,\n           label.padding = unit(0.3,\"lines\")) +\n  scale_x_continuous(\n    labels = function(x) label_percent(accuracy = 1)(abs(x)),\n    limits = c(-0.06,0)\n  )\n\ncu_female22 <- cuba_22 |> filter(gender == \"Female\") |>\n  ggplot(aes(percent,Age)) +\n  geom_col(fill = va_clrs[3]) +\n  annotate(geom = \"label\",\n           family = \"Franklin Gothic Medium\",\n           x = 0.05,\n           y = 17,\n           label = \"Women\",\n           fill = va_clrs[5],\n           color = \"gray30\",\n           label.size = 0,\n           label.padding = unit(0.3, \"lines\")) +\n  scale_x_continuous(\n    labels = function(x) label_percent(accuracy = 1)(abs(x)),\n    limits = c(0,0.06)\n  )\n\ncu_male22 +\n  age_plot +\ncu_female22 +\n  plot_layout(widths = c(7.5,1,7.5)) \n```\n:::\n\n::: {.cell layout-align=\"center\" lightbox='true'}\n::: {.cell-output-display}\n![](img/cu22_pop.png){fig-align='center' width=90%}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}